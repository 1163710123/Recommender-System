Python 3.7.5 (tags/v3.7.5:5c02a39a0b, Oct 15 2019, 00:11:34) [MSC v.1916 64 bit (AMD64)] on win32
runfile('D:/work/PycharmProjects/test/Recommender_System/algorithm/NeuMF/main.py', wdir='D:/work/PycharmProjects/test/Recommender_System/algorithm/NeuMF')
开始读数据ml-100k。共100000条数据，有943个用户，1682个电影。
（耗时0.19547677040100098秒）
开始采集负样本，负正样本比例为30，方法为random。
（耗时1.8383398056030273秒）
开始数据切分，test_ratio=0.2, shuffle=True
（耗时1.0442063808441162秒）
开始准备topk评估数据，n_sample_user=943
（耗时4.924826145172119秒）
初始化GMF模型：n_user=943, n_item=1682, dim=32, l2=1e-05
2019-11-18 20:20:29.554830: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2
开始训练：epochs=15, batch=512
epoch=1, train_loss=0.2318988, train_auc=0.887733877, train_f1=0.150667205, test_loss=0.232524514, test_auc=0.886980414, test_f1=0.149184316
[k=10, precision=22.725%, recall=10.621%, f1=14.476%]
epoch=2, train_loss=0.208332554, train_auc=0.908024073, train_f1=0.353489131, test_loss=0.209183261, test_auc=0.906979561, test_f1=0.351387382
[k=10, precision=25.217%, recall=11.786%, f1=16.064%]
epoch=3, train_loss=0.199685022, train_auc=0.911330223, train_f1=0.361732572, test_loss=0.200630277, test_auc=0.910206437, test_f1=0.358845
[k=10, precision=25.610%, recall=11.969%, f1=16.314%]
epoch=4, train_loss=0.186550811, train_auc=0.925381064, train_f1=0.42612651, test_loss=0.187745571, test_auc=0.923931837, test_f1=0.422394574
[k=10, precision=28.335%, recall=13.243%, f1=18.050%]
epoch=5, train_loss=0.176878601, train_auc=0.936171591, train_f1=0.477595836, test_loss=0.178429484, test_auc=0.934401274, test_f1=0.47287032
[k=10, precision=31.294%, recall=14.626%, f1=19.934%]
epoch=6, train_loss=0.170413256, train_auc=0.942809165, train_f1=0.500216484, test_loss=0.172291696, test_auc=0.940713525, test_f1=0.494373649
[k=10, precision=33.298%, recall=15.562%, f1=21.211%]
epoch=7, train_loss=0.165517792, train_auc=0.947414517, train_f1=0.522696257, test_loss=0.167714104, test_auc=0.945087314, test_f1=0.515768707
[k=10, precision=34.814%, recall=16.271%, f1=22.177%]
epoch=8, train_loss=0.161646485, train_auc=0.951199591, train_f1=0.541893661, test_loss=0.16417481, test_auc=0.948617041, test_f1=0.533617675
[k=10, precision=36.246%, recall=16.940%, f1=23.089%]
epoch=9, train_loss=0.158008546, train_auc=0.954965174, train_f1=0.560592115, test_loss=0.160926506, test_auc=0.952034533, test_f1=0.551003695
[k=10, precision=37.943%, recall=17.733%, f1=24.170%]
epoch=10, train_loss=0.154741615, train_auc=0.958177626, train_f1=0.580584109, test_loss=0.158099383, test_auc=0.954914153, test_f1=0.569571853
[k=10, precision=38.908%, recall=18.184%, f1=24.785%]
epoch=11, train_loss=0.151970595, train_auc=0.961009562, train_f1=0.599778175, test_loss=0.155827299, test_auc=0.957378566, test_f1=0.586824358
[k=10, precision=39.735%, recall=18.571%, f1=25.312%]
epoch=12, train_loss=0.149628535, train_auc=0.963414133, train_f1=0.607577801, test_loss=0.153957739, test_auc=0.959401131, test_f1=0.593196273
[k=10, precision=40.626%, recall=18.987%, f1=25.879%]
epoch=13, train_loss=0.147589251, train_auc=0.96555382, train_f1=0.624757171, test_loss=0.152406901, test_auc=0.961155057, test_f1=0.609458923
[k=10, precision=41.516%, recall=19.403%, f1=26.446%]
epoch=14, train_loss=0.14589645, train_auc=0.967286, train_f1=0.632793903, test_loss=0.151236132, test_auc=0.962490618, test_f1=0.615396857
[k=10, precision=42.047%, recall=19.651%, f1=26.784%]
epoch=15, train_loss=0.1444709, train_auc=0.9686867, train_f1=0.646817, test_loss=0.150310367, test_auc=0.963555872, test_f1=0.627721786
[k=10, precision=42.545%, recall=19.884%, f1=27.102%]
（耗时205.39553499221802秒）
初始化MLP模型：n_user=943, n_item=1682, dim=40, layers=[64, 48, 32], l2=1e-05
开始训练：epochs=15, batch=512
epoch=1, train_loss=0.17526868, train_auc=0.911014378, train_f1=0.402959526, test_loss=0.176379293, test_auc=0.909717917, test_f1=0.399089128
[k=10, precision=25.376%, recall=11.860%, f1=16.165%]
epoch=2, train_loss=0.162165567, train_auc=0.928158, train_f1=0.433938473, test_loss=0.163710207, test_auc=0.926454842, test_f1=0.429609537
[k=10, precision=28.452%, recall=13.297%, f1=18.124%]
epoch=3, train_loss=0.155791163, train_auc=0.937198579, train_f1=0.493894398, test_loss=0.157652572, test_auc=0.935159802, test_f1=0.488385618
[k=10, precision=30.456%, recall=14.234%, f1=19.401%]
epoch=4, train_loss=0.150466174, train_auc=0.943213046, train_f1=0.521260381, test_loss=0.1529558, test_auc=0.940567434, test_f1=0.513903916
[k=10, precision=32.598%, recall=15.235%, f1=20.765%]
epoch=5, train_loss=0.146593407, train_auc=0.947197437, train_f1=0.519541621, test_loss=0.149472743, test_auc=0.944190264, test_f1=0.512009621
[k=10, precision=33.606%, recall=15.706%, f1=21.407%]
epoch=6, train_loss=0.143273577, train_auc=0.951112866, train_f1=0.532547951, test_loss=0.146632195, test_auc=0.947676122, test_f1=0.523862243
[k=10, precision=34.454%, recall=16.102%, f1=21.948%]
epoch=7, train_loss=0.140030235, train_auc=0.954465628, train_f1=0.572173297, test_loss=0.143807098, test_auc=0.950667202, test_f1=0.561544
[k=10, precision=35.175%, recall=16.440%, f1=22.407%]
epoch=8, train_loss=0.1377213, train_auc=0.957756042, train_f1=0.567432225, test_loss=0.142072767, test_auc=0.953332782, test_f1=0.555048227
[k=10, precision=35.875%, recall=16.767%, f1=22.853%]
epoch=9, train_loss=0.135259047, train_auc=0.959911168, train_f1=0.597789, test_loss=0.140268803, test_auc=0.955052, test_f1=0.583756268
[k=10, precision=37.338%, recall=17.451%, f1=23.785%]
epoch=10, train_loss=0.13260901, train_auc=0.962041199, train_f1=0.607753098, test_loss=0.138021082, test_auc=0.95693171, test_f1=0.593533218
[k=10, precision=37.911%, recall=17.718%, f1=24.150%]
epoch=11, train_loss=0.130325302, train_auc=0.964541733, train_f1=0.616953194, test_loss=0.136552602, test_auc=0.958673537, test_f1=0.599290431
[k=10, precision=38.590%, recall=18.035%, f1=24.582%]
epoch=12, train_loss=0.127361894, train_auc=0.966892242, train_f1=0.603530109, test_loss=0.134572104, test_auc=0.960436821, test_f1=0.585581779
[k=10, precision=38.685%, recall=18.080%, f1=24.643%]
epoch=13, train_loss=0.125945449, train_auc=0.967652321, train_f1=0.629557371, test_loss=0.133671626, test_auc=0.960767627, test_f1=0.610500038
[k=10, precision=39.130%, recall=18.288%, f1=24.927%]
epoch=14, train_loss=0.123401672, train_auc=0.969572961, train_f1=0.635020554, test_loss=0.132239193, test_auc=0.96193403, test_f1=0.614331841
[k=10, precision=39.608%, recall=18.511%, f1=25.231%]
epoch=15, train_loss=0.122008324, train_auc=0.972634196, train_f1=0.658439934, test_loss=0.130750626, test_auc=0.964749932, test_f1=0.634320796
[k=10, precision=40.308%, recall=18.838%, f1=25.676%]
（耗时374.00416564941406秒）
初始化NeuMF模型：n_user=943, n_item=1682, gmf_dim=32, mlp_dim=40, layers=[64, 48, 32], l2=1e-05
开始评估：epochs=1, batch=512
epoch=1, train_loss=0.143249497, train_auc=0.975348771, train_f1=0.661070883, test_loss=0.15041025, test_auc=0.969083548, test_f1=0.639305294
[k=10, precision=43.118%, recall=20.152%, f1=27.466%]
（耗时15.662864446640015秒）
开始训练：epochs=30, batch=512
D:\work\PycharmProjects\test\venv3.7\lib\site-packages\tensorflow_core\python\framework\indexed_slices.py:424: UserWarning: Converting sparse IndexedSlices to a dense Tensor of unknown shape. This may consume a large amount of memory.
  "Converting sparse IndexedSlices to a dense Tensor of unknown shape. "
D:\work\PycharmProjects\test\venv3.7\lib\site-packages\tensorflow_core\python\framework\indexed_slices.py:424: UserWarning: Converting sparse IndexedSlices to a dense Tensor of unknown shape. This may consume a large amount of memory.
  "Converting sparse IndexedSlices to a dense Tensor of unknown shape. "
epoch=1, train_loss=0.131626695, train_auc=0.97677803, train_f1=0.70566386, test_loss=0.140925422, test_auc=0.969093263, test_f1=0.67791754
[k=10, precision=43.065%, recall=20.127%, f1=27.433%]
epoch=2, train_loss=0.125608698, train_auc=0.979582071, train_f1=0.71876955, test_loss=0.136225224, test_auc=0.970942199, test_f1=0.686645448
[k=10, precision=43.287%, recall=20.231%, f1=27.575%]
epoch=3, train_loss=0.120594062, train_auc=0.9817276, train_f1=0.74305445, test_loss=0.133150876, test_auc=0.971988797, test_f1=0.706604242
[k=10, precision=43.107%, recall=20.147%, f1=27.460%]
epoch=4, train_loss=0.119269781, train_auc=0.983676076, train_f1=0.755288959, test_loss=0.132343188, test_auc=0.973380923, test_f1=0.715636
[k=10, precision=43.256%, recall=20.216%, f1=27.554%]
epoch=5, train_loss=0.115243703, train_auc=0.984994292, train_f1=0.76996851, test_loss=0.130100861, test_auc=0.973862052, test_f1=0.72795856
[k=10, precision=43.446%, recall=20.305%, f1=27.676%]
epoch=6, train_loss=0.112673305, train_auc=0.986730337, train_f1=0.781998754, test_loss=0.128480628, test_auc=0.974889457, test_f1=0.736425
[k=10, precision=44.168%, recall=20.642%, f1=28.135%]
epoch=7, train_loss=0.109156378, train_auc=0.987022579, train_f1=0.777222753, test_loss=0.127248138, test_auc=0.973943412, test_f1=0.73143667
[k=10, precision=44.231%, recall=20.672%, f1=28.176%]
epoch=8, train_loss=0.10885971, train_auc=0.987891436, train_f1=0.797888398, test_loss=0.127295494, test_auc=0.974885106, test_f1=0.749301791
[k=10, precision=44.019%, recall=20.573%, f1=28.041%]
epoch=9, train_loss=0.106287897, train_auc=0.989120483, train_f1=0.795676053, test_loss=0.125503018, test_auc=0.975515723, test_f1=0.745682597
[k=10, precision=44.677%, recall=20.880%, f1=28.459%]
epoch=10, train_loss=0.105483845, train_auc=0.989777386, train_f1=0.792465568, test_loss=0.125596672, test_auc=0.975566328, test_f1=0.74064672
[k=10, precision=43.690%, recall=20.419%, f1=27.831%]
epoch=11, train_loss=0.103972174, train_auc=0.990078926, train_f1=0.801819205, test_loss=0.125666827, test_auc=0.975053966, test_f1=0.748273551
[k=10, precision=44.008%, recall=20.568%, f1=28.034%]
epoch=12, train_loss=0.102954917, train_auc=0.990737557, train_f1=0.820536375, test_loss=0.124787726, test_auc=0.976111233, test_f1=0.765538454
[k=10, precision=44.337%, recall=20.722%, f1=28.243%]
epoch=13, train_loss=0.101886995, train_auc=0.991220653, train_f1=0.826445, test_loss=0.124788344, test_auc=0.975835741, test_f1=0.769722462
[k=10, precision=43.924%, recall=20.528%, f1=27.980%]
epoch=14, train_loss=0.101547703, train_auc=0.991733968, train_f1=0.830290079, test_loss=0.124751545, test_auc=0.976176322, test_f1=0.772543073
[k=10, precision=44.072%, recall=20.598%, f1=28.074%]
epoch=15, train_loss=0.101757281, train_auc=0.991969585, train_f1=0.830649197, test_loss=0.125153989, test_auc=0.976427495, test_f1=0.77151835
[k=10, precision=43.669%, recall=20.409%, f1=27.818%]
epoch=16, train_loss=0.100766204, train_auc=0.992234826, train_f1=0.838573575, test_loss=0.125203446, test_auc=0.976199627, test_f1=0.778334796
[k=10, precision=43.881%, recall=20.508%, f1=27.953%]
epoch=17, train_loss=0.100388959, train_auc=0.992200196, train_f1=0.834850371, test_loss=0.125629246, test_auc=0.975557327, test_f1=0.774831
[k=10, precision=43.796%, recall=20.469%, f1=27.899%]
epoch=18, train_loss=0.0997126549, train_auc=0.992950499, train_f1=0.845401883, test_loss=0.124976709, test_auc=0.97654444, test_f1=0.783700407
[k=10, precision=43.892%, recall=20.513%, f1=27.960%]
epoch=19, train_loss=0.0981616899, train_auc=0.993109, train_f1=0.849303961, test_loss=0.124687865, test_auc=0.976008654, test_f1=0.787332416
[k=10, precision=44.093%, recall=20.608%, f1=28.088%]
epoch=20, train_loss=0.0979641825, train_auc=0.993425071, train_f1=0.850929081, test_loss=0.124602973, test_auc=0.976481736, test_f1=0.787930131
[k=10, precision=43.796%, recall=20.469%, f1=27.899%]
epoch=21, train_loss=0.0979026556, train_auc=0.993500948, train_f1=0.854741216, test_loss=0.12491636, test_auc=0.976176918, test_f1=0.791403294
[k=10, precision=43.977%, recall=20.553%, f1=28.014%]
epoch=22, train_loss=0.0969985798, train_auc=0.993510544, train_f1=0.853669643, test_loss=0.125083283, test_auc=0.97557354, test_f1=0.790293
[k=10, precision=44.030%, recall=20.578%, f1=28.047%]
epoch=23, train_loss=0.0976383165, train_auc=0.99371469, train_f1=0.858663559, test_loss=0.12577571, test_auc=0.976388633, test_f1=0.793973
[k=10, precision=43.277%, recall=20.226%, f1=27.568%]
epoch=24, train_loss=0.0986275151, train_auc=0.993968487, train_f1=0.863371372, test_loss=0.126259372, test_auc=0.976776, test_f1=0.798625588
[k=10, precision=43.256%, recall=20.216%, f1=27.554%]
epoch=25, train_loss=0.0972673073, train_auc=0.99397862, train_f1=0.862323523, test_loss=0.125861213, test_auc=0.976452053, test_f1=0.796935
[k=10, precision=43.574%, recall=20.365%, f1=27.757%]
epoch=26, train_loss=0.0954643935, train_auc=0.993934274, train_f1=0.85512054, test_loss=0.125484541, test_auc=0.975348592, test_f1=0.790483594
[k=10, precision=43.966%, recall=20.548%, f1=28.007%]
epoch=27, train_loss=0.0966925547, train_auc=0.994108, train_f1=0.861823499, test_loss=0.125988841, test_auc=0.976101637, test_f1=0.795058072
[k=10, precision=42.831%, recall=20.018%, f1=27.284%]
epoch=28, train_loss=0.0949598923, train_auc=0.994615793, train_f1=0.869829595, test_loss=0.124872707, test_auc=0.976484478, test_f1=0.802576244
[k=10, precision=43.818%, recall=20.479%, f1=27.912%]
epoch=29, train_loss=0.0952145532, train_auc=0.994430065, train_f1=0.865377724, test_loss=0.125451714, test_auc=0.975910306, test_f1=0.798710406
[k=10, precision=43.181%, recall=20.181%, f1=27.507%]
epoch=30, train_loss=0.09495496, train_auc=0.994773924, train_f1=0.865091801, test_loss=0.125010327, test_auc=0.976026773, test_f1=0.797302663
[k=10, precision=43.446%, recall=20.305%, f1=27.676%]
（耗时962.8410727977753秒）
