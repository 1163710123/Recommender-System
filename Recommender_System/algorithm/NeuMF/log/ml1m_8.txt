Python 3.7.5 (tags/v3.7.5:5c02a39a0b, Oct 15 2019, 00:11:34) [MSC v.1916 64 bit (AMD64)] on win32
runfile('D:/work/PycharmProjects/test/Recommender_System/algorithm/NeuMF/main.py', wdir='D:/work/PycharmProjects/test/Recommender_System/algorithm/NeuMF')
开始读数据ml-1m。共1000209条数据，有6040个用户，3706个电影。
（耗时1.9221370220184326秒）
开始采集负样本，负正样本比例为1，方法为random。
（耗时7.7238264083862305秒）
开始数据切分，test_ratio=0.2, shuffle=True
（耗时1.4017972946166992秒）
开始准备topk评估数据，n_sample_user=100
（耗时5.152431964874268秒）
初始化NeuMF模型：n_user=6040, n_item=3706, gmf_dim=8, mlp_dim=32, layers=[32, 16, 8], l2=0
2019-11-22 15:13:48.536622: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2
开始训练：epochs=50, batch=512
epoch=1, train_loss=0.405950338, train_auc=0.897026181, train_f1=0.820736825, test_loss=0.40881, test_auc=0.895246387, test_f1=0.819113374
[k=10, precision=25.500%, recall=6.879%, f1=10.835%][k=36, precision=18.389%, recall=17.858%, f1=18.120%][k=100, precision=12.900%, recall=34.799%, f1=18.822%]
epoch=2, train_loss=0.353438526, train_auc=0.922647059, train_f1=0.845452189, test_loss=0.359924555, test_auc=0.919353724, test_f1=0.84215939
[k=10, precision=28.200%, recall=7.607%, f1=11.982%][k=36, precision=20.333%, recall=19.746%, f1=20.036%][k=100, precision=14.580%, recall=39.331%, f1=21.274%]
epoch=3, train_loss=0.327312738, train_auc=0.933591068, train_f1=0.859205067, test_loss=0.33675465, test_auc=0.929329515, test_f1=0.8545959
[k=10, precision=31.000%, recall=8.363%, f1=13.172%][k=36, precision=21.583%, recall=20.960%, f1=21.267%][k=100, precision=15.000%, recall=40.464%, f1=21.887%]
epoch=4, train_loss=0.310542762, train_auc=0.940538168, train_f1=0.869326, test_loss=0.322889298, test_auc=0.935372, test_f1=0.863659322
[k=10, precision=31.800%, recall=8.578%, f1=13.512%][k=36, precision=22.278%, recall=21.635%, f1=21.952%][k=100, precision=15.540%, recall=41.921%, f1=22.675%]
epoch=5, train_loss=0.296190858, train_auc=0.946199417, train_f1=0.875509, test_loss=0.31103465, test_auc=0.940066278, test_f1=0.868410289
[k=10, precision=31.700%, recall=8.551%, f1=13.469%][k=36, precision=22.194%, recall=21.554%, f1=21.869%][k=100, precision=15.350%, recall=41.408%, f1=22.397%]
epoch=6, train_loss=0.284826577, train_auc=0.950187147, train_f1=0.881148636, test_loss=0.302609, test_auc=0.943276048, test_f1=0.873103321
[k=10, precision=31.700%, recall=8.551%, f1=13.469%][k=36, precision=22.250%, recall=21.608%, f1=21.924%][k=100, precision=15.450%, recall=41.678%, f1=22.543%]
epoch=7, train_loss=0.274454504, train_auc=0.95349586, train_f1=0.884868, test_loss=0.295233637, test_auc=0.945839882, test_f1=0.87559396
[k=10, precision=31.200%, recall=8.417%, f1=13.257%][k=36, precision=22.139%, recall=21.500%, f1=21.815%][k=100, precision=15.390%, recall=41.516%, f1=22.456%]
epoch=8, train_loss=0.265005857, train_auc=0.956800103, train_f1=0.890607715, test_loss=0.288761705, test_auc=0.948232532, test_f1=0.880108833
[k=10, precision=30.400%, recall=8.201%, f1=12.917%][k=36, precision=22.472%, recall=21.824%, f1=22.143%][k=100, precision=15.250%, recall=41.138%, f1=22.251%]
epoch=9, train_loss=0.258778334, train_auc=0.959400296, train_f1=0.892240942, test_loss=0.285318285, test_auc=0.949906349, test_f1=0.880405724
[k=10, precision=29.500%, recall=7.958%, f1=12.535%][k=36, precision=21.444%, recall=20.825%, f1=21.130%][k=100, precision=15.060%, recall=40.626%, f1=21.974%]
epoch=10, train_loss=0.249778479, train_auc=0.961897314, train_f1=0.898857832, test_loss=0.279469579, test_auc=0.951775789, test_f1=0.886464
[k=10, precision=28.000%, recall=7.553%, f1=11.897%][k=36, precision=21.361%, recall=20.745%, f1=21.048%][k=100, precision=15.070%, recall=40.653%, f1=21.989%]
epoch=11, train_loss=0.242805228, train_auc=0.963556409, train_f1=0.901114047, test_loss=0.275447041, test_auc=0.952998221, test_f1=0.88803643
[k=10, precision=27.700%, recall=7.472%, f1=11.770%][k=36, precision=21.333%, recall=20.718%, f1=21.021%][k=100, precision=15.060%, recall=40.626%, f1=21.974%]
epoch=12, train_loss=0.237377718, train_auc=0.965642452, train_f1=0.905152798, test_loss=0.272662103, test_auc=0.954162359, test_f1=0.89078927
[k=10, precision=26.600%, recall=7.176%, f1=11.302%][k=36, precision=20.861%, recall=20.259%, f1=20.556%][k=100, precision=14.780%, recall=39.871%, f1=21.566%]
epoch=13, train_loss=0.231377259, train_auc=0.967021942, train_f1=0.907529891, test_loss=0.270217061, test_auc=0.955099583, test_f1=0.892570555
[k=10, precision=26.900%, recall=7.257%, f1=11.430%][k=36, precision=20.583%, recall=19.989%, f1=20.282%][k=100, precision=14.820%, recall=39.978%, f1=21.624%]
epoch=14, train_loss=0.22618486, train_auc=0.968913078, train_f1=0.909304261, test_loss=0.267037481, test_auc=0.956106782, test_f1=0.89326328
[k=10, precision=24.100%, recall=6.501%, f1=10.240%][k=36, precision=19.694%, recall=19.126%, f1=19.406%][k=100, precision=14.190%, recall=38.279%, f1=20.705%]
epoch=15, train_loss=0.221921086, train_auc=0.970237076, train_f1=0.910506, test_loss=0.265697092, test_auc=0.956814647, test_f1=0.893388152
[k=10, precision=24.600%, recall=6.636%, f1=10.453%][k=36, precision=19.861%, recall=19.288%, f1=19.570%][k=100, precision=14.140%, recall=38.144%, f1=20.632%]
epoch=16, train_loss=0.217907831, train_auc=0.971441567, train_f1=0.911596417, test_loss=0.264407098, test_auc=0.957615137, test_f1=0.893749237
[k=10, precision=24.900%, recall=6.717%, f1=10.580%][k=36, precision=19.028%, recall=18.479%, f1=18.749%][k=100, precision=13.940%, recall=37.605%, f1=20.340%]
epoch=17, train_loss=0.211729825, train_auc=0.972180724, train_f1=0.91554004, test_loss=0.260993183, test_auc=0.95845753, test_f1=0.897941828
[k=10, precision=24.600%, recall=6.636%, f1=10.453%][k=36, precision=19.611%, recall=19.045%, f1=19.324%][k=100, precision=14.310%, recall=38.603%, f1=20.880%]
epoch=18, train_loss=0.208588928, train_auc=0.973238707, train_f1=0.916884303, test_loss=0.260240078, test_auc=0.958787739, test_f1=0.898394227
[k=10, precision=23.900%, recall=6.447%, f1=10.155%][k=36, precision=19.000%, recall=18.452%, f1=18.722%][k=100, precision=14.020%, recall=37.820%, f1=20.457%]
epoch=19, train_loss=0.204781666, train_auc=0.974182844, train_f1=0.919050574, test_loss=0.25871256, test_auc=0.959352553, test_f1=0.900176585
[k=10, precision=23.500%, recall=6.339%, f1=9.985%][k=36, precision=18.944%, recall=18.398%, f1=18.667%][k=100, precision=13.760%, recall=37.119%, f1=20.077%]
epoch=20, train_loss=0.201680884, train_auc=0.974582195, train_f1=0.919041693, test_loss=0.258820027, test_auc=0.95976752, test_f1=0.900228918
[k=10, precision=23.700%, recall=6.393%, f1=10.070%][k=36, precision=19.194%, recall=18.640%, f1=18.913%][k=100, precision=13.880%, recall=37.443%, f1=20.252%]
epoch=21, train_loss=0.198272809, train_auc=0.975507855, train_f1=0.921054959, test_loss=0.257798016, test_auc=0.960221231, test_f1=0.901699185
[k=10, precision=23.400%, recall=6.312%, f1=9.943%][k=36, precision=18.639%, recall=18.101%, f1=18.366%][k=100, precision=13.770%, recall=37.146%, f1=20.092%]
epoch=22, train_loss=0.197244808, train_auc=0.975883067, train_f1=0.921696723, test_loss=0.257797688, test_auc=0.960432, test_f1=0.902509212
[k=10, precision=22.500%, recall=6.070%, f1=9.560%][k=36, precision=18.361%, recall=17.831%, f1=18.092%][k=100, precision=13.630%, recall=36.768%, f1=19.888%]
epoch=23, train_loss=0.1938373, train_auc=0.976937294, train_f1=0.922974586, test_loss=0.258303314, test_auc=0.960315049, test_f1=0.901800275
[k=10, precision=21.100%, recall=5.692%, f1=8.965%][k=36, precision=17.000%, recall=16.509%, f1=16.751%][k=100, precision=12.910%, recall=34.826%, f1=18.837%]
epoch=24, train_loss=0.190268666, train_auc=0.977613389, train_f1=0.924488425, test_loss=0.256064862, test_auc=0.961153626, test_f1=0.903622448
[k=10, precision=22.000%, recall=5.935%, f1=9.348%][k=36, precision=17.528%, recall=17.022%, f1=17.271%][k=100, precision=13.030%, recall=35.150%, f1=19.012%]
epoch=25, train_loss=0.18845278, train_auc=0.97799927, train_f1=0.925144792, test_loss=0.256828785, test_auc=0.961176336, test_f1=0.903945923
[k=10, precision=20.800%, recall=5.611%, f1=8.838%][k=36, precision=17.306%, recall=16.806%, f1=17.052%][k=100, precision=12.780%, recall=34.475%, f1=18.647%]
epoch=26, train_loss=0.186056852, train_auc=0.978569031, train_f1=0.92665422, test_loss=0.256656528, test_auc=0.961363792, test_f1=0.905067801
[k=10, precision=20.900%, recall=5.638%, f1=8.880%][k=36, precision=17.278%, recall=16.779%, f1=17.025%][k=100, precision=12.840%, recall=34.637%, f1=18.735%]
epoch=27, train_loss=0.184455052, train_auc=0.979060173, train_f1=0.925904036, test_loss=0.258443147, test_auc=0.96160835, test_f1=0.903680086
[k=10, precision=20.700%, recall=5.584%, f1=8.795%][k=36, precision=16.806%, recall=16.320%, f1=16.559%][k=100, precision=12.700%, recall=34.260%, f1=18.531%]
epoch=28, train_loss=0.181288242, train_auc=0.979428351, train_f1=0.928782463, test_loss=0.256513298, test_auc=0.9619537, test_f1=0.906991899
[k=10, precision=20.800%, recall=5.611%, f1=8.838%][k=36, precision=16.750%, recall=16.267%, f1=16.505%][k=100, precision=12.730%, recall=34.340%, f1=18.574%]
epoch=29, train_loss=0.180285513, train_auc=0.979659319, train_f1=0.928697586, test_loss=0.256737381, test_auc=0.962045968, test_f1=0.906772494
[k=10, precision=19.400%, recall=5.233%, f1=8.243%][k=36, precision=16.917%, recall=16.428%, f1=16.669%][k=100, precision=12.840%, recall=34.637%, f1=18.735%]
epoch=30, train_loss=0.179736152, train_auc=0.979875624, train_f1=0.929152548, test_loss=0.258535802, test_auc=0.962280214, test_f1=0.907651246
[k=10, precision=19.700%, recall=5.314%, f1=8.371%][k=36, precision=16.667%, recall=16.186%, f1=16.423%][k=100, precision=12.890%, recall=34.772%, f1=18.808%]
epoch=31, train_loss=0.176730514, train_auc=0.980621576, train_f1=0.930332065, test_loss=0.256582558, test_auc=0.962355673, test_f1=0.90770483
[k=10, precision=18.500%, recall=4.991%, f1=7.861%][k=36, precision=15.528%, recall=15.080%, f1=15.300%][k=100, precision=12.250%, recall=33.046%, f1=17.874%]
epoch=32, train_loss=0.175552577, train_auc=0.980819166, train_f1=0.931265891, test_loss=0.257527232, test_auc=0.962580383, test_f1=0.908943534
[k=10, precision=19.100%, recall=5.152%, f1=8.116%][k=36, precision=16.028%, recall=15.565%, f1=15.793%][k=100, precision=12.530%, recall=33.801%, f1=18.283%]
epoch=33, train_loss=0.173606157, train_auc=0.981172562, train_f1=0.931678, test_loss=0.257213116, test_auc=0.962602079, test_f1=0.908566594
[k=10, precision=18.900%, recall=5.098%, f1=8.031%][k=36, precision=15.722%, recall=15.268%, f1=15.492%][k=100, precision=12.280%, recall=33.127%, f1=17.918%]
epoch=34, train_loss=0.173209488, train_auc=0.981343567, train_f1=0.931439281, test_loss=0.258708626, test_auc=0.962341785, test_f1=0.907962799
[k=10, precision=18.200%, recall=4.910%, f1=7.733%][k=36, precision=15.306%, recall=14.864%, f1=15.081%][k=100, precision=11.960%, recall=32.263%, f1=17.451%]
epoch=35, train_loss=0.170518652, train_auc=0.981849492, train_f1=0.932907283, test_loss=0.259310782, test_auc=0.962533, test_f1=0.908992112
[k=10, precision=18.000%, recall=4.856%, f1=7.648%][k=36, precision=14.972%, recall=14.540%, f1=14.753%][k=100, precision=11.980%, recall=32.317%, f1=17.480%]
epoch=36, train_loss=0.169414729, train_auc=0.982064486, train_f1=0.933695793, test_loss=0.25887087, test_auc=0.96268779, test_f1=0.909789503
[k=10, precision=17.200%, recall=4.640%, f1=7.308%][k=36, precision=14.917%, recall=14.486%, f1=14.698%][k=100, precision=11.840%, recall=31.940%, f1=17.276%]
epoch=37, train_loss=0.170151636, train_auc=0.982217848, train_f1=0.931821167, test_loss=0.262001723, test_auc=0.962632358, test_f1=0.907351851
[k=10, precision=18.300%, recall=4.937%, f1=7.776%][k=36, precision=14.944%, recall=14.513%, f1=14.726%][k=100, precision=11.850%, recall=31.967%, f1=17.290%]
epoch=38, train_loss=0.167481765, train_auc=0.982483208, train_f1=0.933126, test_loss=0.261044323, test_auc=0.962890267, test_f1=0.908833146
[k=10, precision=18.100%, recall=4.883%, f1=7.691%][k=36, precision=15.278%, recall=14.837%, f1=15.054%][k=100, precision=12.000%, recall=32.371%, f1=17.509%]
epoch=39, train_loss=0.165733904, train_auc=0.982695937, train_f1=0.934523404, test_loss=0.260609269, test_auc=0.962975383, test_f1=0.910313189
[k=10, precision=17.400%, recall=4.694%, f1=7.393%][k=36, precision=14.556%, recall=14.135%, f1=14.342%][k=100, precision=12.060%, recall=32.533%, f1=17.597%]
epoch=40, train_loss=0.167140141, train_auc=0.982974, train_f1=0.935090303, test_loss=0.263418525, test_auc=0.96293211, test_f1=0.911477387
[k=10, precision=16.200%, recall=4.370%, f1=6.883%][k=36, precision=14.194%, recall=13.785%, f1=13.987%][k=100, precision=11.450%, recall=30.888%, f1=16.707%]
epoch=41, train_loss=0.16431196, train_auc=0.983295381, train_f1=0.935987592, test_loss=0.262946844, test_auc=0.962833285, test_f1=0.911599815
[k=10, precision=16.000%, recall=4.316%, f1=6.798%][k=36, precision=14.139%, recall=13.731%, f1=13.932%][k=100, precision=11.410%, recall=30.780%, f1=16.648%]
epoch=42, train_loss=0.16238308, train_auc=0.983323336, train_f1=0.936006784, test_loss=0.262847513, test_auc=0.963123083, test_f1=0.911634
[k=10, precision=17.000%, recall=4.586%, f1=7.223%][k=36, precision=14.583%, recall=14.162%, f1=14.370%][k=100, precision=11.670%, recall=31.481%, f1=17.028%]
epoch=43, train_loss=0.161495149, train_auc=0.983581483, train_f1=0.937029421, test_loss=0.26342836, test_auc=0.963080168, test_f1=0.912403822
[k=10, precision=17.000%, recall=4.586%, f1=7.223%][k=36, precision=14.444%, recall=14.028%, f1=14.233%][k=100, precision=11.410%, recall=30.780%, f1=16.648%]
epoch=44, train_loss=0.161115542, train_auc=0.983757257, train_f1=0.937185645, test_loss=0.26413691, test_auc=0.962806523, test_f1=0.912018776
[k=10, precision=15.600%, recall=4.208%, f1=6.628%][k=36, precision=13.667%, recall=13.272%, f1=13.467%][k=100, precision=11.150%, recall=30.078%, f1=16.269%]
epoch=45, train_loss=0.160385028, train_auc=0.983936489, train_f1=0.93757391, test_loss=0.266746491, test_auc=0.962739885, test_f1=0.912510157
[k=10, precision=16.000%, recall=4.316%, f1=6.798%][k=36, precision=13.250%, recall=12.868%, f1=13.056%][k=100, precision=11.040%, recall=29.781%, f1=16.109%]
epoch=46, train_loss=0.157989278, train_auc=0.984166503, train_f1=0.93792671, test_loss=0.265105844, test_auc=0.963202715, test_f1=0.912526309
[k=10, precision=16.400%, recall=4.424%, f1=6.968%][k=36, precision=13.694%, recall=13.299%, f1=13.494%][k=100, precision=11.250%, recall=30.348%, f1=16.415%]
epoch=47, train_loss=0.158110872, train_auc=0.98424989, train_f1=0.937834799, test_loss=0.265675634, test_auc=0.963033438, test_f1=0.912203312
[k=10, precision=15.400%, recall=4.154%, f1=6.543%][k=36, precision=12.861%, recall=12.490%, f1=12.673%][k=100, precision=10.960%, recall=29.566%, f1=15.992%]
epoch=48, train_loss=0.157314479, train_auc=0.984582, train_f1=0.938874602, test_loss=0.266871423, test_auc=0.963177, test_f1=0.913545132
[k=10, precision=16.700%, recall=4.505%, f1=7.096%][k=36, precision=13.000%, recall=12.625%, f1=12.810%][k=100, precision=10.910%, recall=29.431%, f1=15.919%]
epoch=49, train_loss=0.156267017, train_auc=0.984669209, train_f1=0.939120471, test_loss=0.265599787, test_auc=0.96331346, test_f1=0.913648844
[k=10, precision=15.900%, recall=4.289%, f1=6.756%][k=36, precision=13.111%, recall=12.733%, f1=12.919%][k=100, precision=11.110%, recall=29.970%, f1=16.211%]
epoch=50, train_loss=0.154713273, train_auc=0.98474735, train_f1=0.93944937, test_loss=0.267229229, test_auc=0.963382959, test_f1=0.913683
[k=10, precision=17.500%, recall=4.721%, f1=7.436%][k=36, precision=13.722%, recall=13.326%, f1=13.521%][k=100, precision=11.170%, recall=30.132%, f1=16.298%]
（耗时1618.4600546360016秒）
