Python 3.7.5 (tags/v3.7.5:5c02a39a0b, Oct 15 2019, 00:11:34) [MSC v.1916 64 bit (AMD64)] on win32
runfile('D:/work/PycharmProjects/test/Recommender_System/algorithm/LFM/main.py', wdir='D:/work/PycharmProjects/test/Recommender_System/algorithm/LFM')
开始读数据lastfm。共92834条数据，有1892个用户，17632个艺术家。
（耗时0.1825118064880371秒）
开始采集负样本，负正样本比例为1，方法为random。
（耗时13.598225831985474秒）
开始数据切分，test_ratio=0.2, shuffle=True
（耗时0.1456127166748047秒）
开始准备topk评估数据，n_sample_user=100
（耗时0.6153526306152344秒）
初始化LFM模型：n_user=1892, n_item=17632, dim=128, l2=1e-05
2019-11-20 15:59:59.819392: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2
开始训练：epochs=30, batch=512
epoch=1, train_loss=0.463548899, train_auc=0.840750456, train_f1=-nan(ind), test_loss=0.466080666, test_auc=0.819748163, test_f1=-nan(ind)
[k=10, precision=7.500%, recall=8.091%, f1=7.784%]
epoch=2, train_loss=0.201394141, train_auc=0.908380926, train_f1=0.695675313, test_loss=0.207647771, test_auc=0.891078532, test_f1=0.689327538
[k=10, precision=9.000%, recall=9.709%, f1=9.341%]
epoch=3, train_loss=0.154056638, train_auc=0.940469146, train_f1=0.82026422, test_loss=0.164448991, test_auc=0.918085515, test_f1=0.810464561
[k=10, precision=9.300%, recall=10.032%, f1=9.652%]
epoch=4, train_loss=0.136339, train_auc=0.967431486, train_f1=0.866912246, test_loss=0.150493518, test_auc=0.941477656, test_f1=0.852735
[k=10, precision=9.600%, recall=10.356%, f1=9.964%]
epoch=5, train_loss=0.124984927, train_auc=0.983359575, train_f1=0.911268294, test_loss=0.142269149, test_auc=0.956189692, test_f1=0.891011834
[k=10, precision=10.900%, recall=11.758%, f1=11.313%]
epoch=6, train_loss=0.118498459, train_auc=0.990395069, train_f1=0.943324208, test_loss=0.137962252, test_auc=0.963622034, test_f1=0.918283403
[k=10, precision=10.700%, recall=11.543%, f1=11.105%]
epoch=7, train_loss=0.11487139, train_auc=0.993259966, train_f1=0.962909222, test_loss=0.135758519, test_auc=0.967285097, test_f1=0.935237
[k=10, precision=10.000%, recall=10.787%, f1=10.379%]
epoch=8, train_loss=0.112875164, train_auc=0.994522035, train_f1=0.97429508, test_loss=0.134738371, test_auc=0.969261408, test_f1=0.94510448
[k=10, precision=9.800%, recall=10.572%, f1=10.171%]
epoch=9, train_loss=0.11175447, train_auc=0.995219469, train_f1=0.980947614, test_loss=0.134225428, test_auc=0.970585763, test_f1=0.950874031
[k=10, precision=9.400%, recall=10.140%, f1=9.756%]
epoch=10, train_loss=0.110958219, train_auc=0.995592594, train_f1=0.985460222, test_loss=0.133881286, test_auc=0.971401811, test_f1=0.954541326
[k=10, precision=9.800%, recall=10.572%, f1=10.171%]
epoch=11, train_loss=0.110439487, train_auc=0.995841444, train_f1=0.988177657, test_loss=0.133659914, test_auc=0.972064435, test_f1=0.956988513
[k=10, precision=9.800%, recall=10.572%, f1=10.171%]
epoch=12, train_loss=0.11012052, train_auc=0.996017754, train_f1=0.989665449, test_loss=0.133602098, test_auc=0.972449422, test_f1=0.958337247
[k=10, precision=10.100%, recall=10.895%, f1=10.483%]
epoch=13, train_loss=0.109854855, train_auc=0.996130168, train_f1=0.990969241, test_loss=0.133513287, test_auc=0.972800314, test_f1=0.959430516
[k=10, precision=10.700%, recall=11.543%, f1=11.105%]
epoch=14, train_loss=0.10966298, train_auc=0.996190965, train_f1=0.991976, test_loss=0.133416563, test_auc=0.973018765, test_f1=0.960159481
[k=10, precision=9.900%, recall=10.680%, f1=10.275%]
epoch=15, train_loss=0.109515518, train_auc=0.996259928, train_f1=0.992547214, test_loss=0.13334015, test_auc=0.973260343, test_f1=0.960764289
[k=10, precision=10.600%, recall=11.435%, f1=11.002%]
epoch=16, train_loss=0.109385133, train_auc=0.996349216, train_f1=0.992967904, test_loss=0.133271411, test_auc=0.973480463, test_f1=0.961083889
[k=10, precision=9.800%, recall=10.572%, f1=10.171%]
epoch=17, train_loss=0.109294839, train_auc=0.996390879, train_f1=0.993335366, test_loss=0.133244157, test_auc=0.973564267, test_f1=0.96147269
[k=10, precision=9.900%, recall=10.680%, f1=10.275%]
epoch=18, train_loss=0.109186105, train_auc=0.996481597, train_f1=0.993681669, test_loss=0.133184031, test_auc=0.973771214, test_f1=0.961747587
[k=10, precision=10.700%, recall=11.543%, f1=11.105%]
epoch=19, train_loss=0.109136827, train_auc=0.996509969, train_f1=0.993715, test_loss=0.133127034, test_auc=0.973937511, test_f1=0.961737454
[k=10, precision=10.500%, recall=11.327%, f1=10.898%]
epoch=20, train_loss=0.109016202, train_auc=0.996555626, train_f1=0.993905604, test_loss=0.133025318, test_auc=0.974029958, test_f1=0.962043703
[k=10, precision=10.200%, recall=11.003%, f1=10.586%]
epoch=21, train_loss=0.108910017, train_auc=0.996585727, train_f1=0.994095504, test_loss=0.132905975, test_auc=0.974143267, test_f1=0.962049305
[k=10, precision=11.300%, recall=12.190%, f1=11.728%]
epoch=22, train_loss=0.108828969, train_auc=0.996593, train_f1=0.994143, test_loss=0.132861361, test_auc=0.974151075, test_f1=0.962201059
[k=10, precision=11.100%, recall=11.974%, f1=11.520%]
epoch=23, train_loss=0.108751848, train_auc=0.99663651, train_f1=0.994346857, test_loss=0.132803261, test_auc=0.974215, test_f1=0.962302506
[k=10, precision=9.800%, recall=10.572%, f1=10.171%]
epoch=24, train_loss=0.108718559, train_auc=0.99666363, train_f1=0.994305909, test_loss=0.132757202, test_auc=0.974307239, test_f1=0.962238848
[k=10, precision=10.700%, recall=11.543%, f1=11.105%]
epoch=25, train_loss=0.108616658, train_auc=0.996687412, train_f1=0.994523227, test_loss=0.132704973, test_auc=0.974379301, test_f1=0.962406695
[k=10, precision=11.100%, recall=11.974%, f1=11.520%]
epoch=26, train_loss=0.108531438, train_auc=0.996702731, train_f1=0.994570553, test_loss=0.132617071, test_auc=0.974407852, test_f1=0.962515831
[k=10, precision=12.100%, recall=13.053%, f1=12.558%]
epoch=27, train_loss=0.108507343, train_auc=0.996749222, train_f1=0.994536519, test_loss=0.132587954, test_auc=0.974532187, test_f1=0.962627769
[k=10, precision=10.800%, recall=11.650%, f1=11.209%]
epoch=28, train_loss=0.108445056, train_auc=0.996757805, train_f1=0.994740546, test_loss=0.132543534, test_auc=0.974535227, test_f1=0.962576151
[k=10, precision=11.000%, recall=11.866%, f1=11.417%]
epoch=29, train_loss=0.108372487, train_auc=0.996811152, train_f1=0.994618177, test_loss=0.132466406, test_auc=0.97462815, test_f1=0.962620437
[k=10, precision=10.600%, recall=11.435%, f1=11.002%]
epoch=30, train_loss=0.108346172, train_auc=0.996816278, train_f1=0.994774461, test_loss=0.132455721, test_auc=0.974640429, test_f1=0.962672532
[k=10, precision=11.400%, recall=12.298%, f1=11.832%]
（耗时292.17620635032654秒）