Python 3.7.5 (tags/v3.7.5:5c02a39a0b, Oct 15 2019, 00:11:34) [MSC v.1916 64 bit (AMD64)] on win32
runfile('D:/work/PycharmProjects/test/Recommender_System/algorithm/GMF/main.py', wdir='D:/work/PycharmProjects/test/Recommender_System/algorithm/GMF')
开始读数据ml-1m。共1000209条数据，有6040个用户，3706个电影。
（耗时2.0349714756011963秒）
开始采集负样本，负正样本比例为5，方法为random。
（耗时10.693764925003052秒）
开始数据切分，test_ratio=0.2, shuffle=True
（耗时4.51455020904541秒）
开始准备topk评估数据，n_sample_user=6040
（耗时36.786006689071655秒）
初始化GMF模型：n_user=6040, n_item=3706, dim=64, l2=2e-06
2019-11-20 10:41:59.367472: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2
开始训练：epochs=30, batch=512
epoch=1, train_loss=0.299811542, train_auc=0.904687941, train_f1=0.590873778, test_loss=0.301188171, test_auc=0.903500617, test_f1=0.588593602
[k=10, precision=25.990%, recall=7.847%, f1=12.054%]
epoch=2, train_loss=0.262636721, train_auc=0.932726502, train_f1=0.672788143, test_loss=0.265833169, test_auc=0.930502892, test_f1=0.667738914
[k=10, precision=32.177%, recall=9.715%, f1=14.924%]
epoch=3, train_loss=0.247115955, train_auc=0.943380654, train_f1=0.704763472, test_loss=0.252027273, test_auc=0.940239072, test_f1=0.697052062
[k=10, precision=34.776%, recall=10.499%, f1=16.129%]
epoch=4, train_loss=0.234608591, train_auc=0.951581776, train_f1=0.731243551, test_loss=0.241675407, test_auc=0.94736141, test_f1=0.720070481
[k=10, precision=35.983%, recall=10.864%, f1=16.689%]
epoch=5, train_loss=0.225649565, train_auc=0.957269192, train_f1=0.751193166, test_loss=0.234930262, test_auc=0.952024519, test_f1=0.736888349
[k=10, precision=36.220%, recall=10.935%, f1=16.799%]
epoch=6, train_loss=0.220449, train_auc=0.960571468, train_f1=0.762016594, test_loss=0.23141931, test_auc=0.954574406, test_f1=0.745388389
[k=10, precision=36.310%, recall=10.962%, f1=16.840%]
epoch=7, train_loss=0.217847466, train_auc=0.962210059, train_f1=0.767780602, test_loss=0.229892373, test_auc=0.955741346, test_f1=0.749964
[k=10, precision=36.373%, recall=10.981%, f1=16.869%]
epoch=8, train_loss=0.216314629, train_auc=0.963207424, train_f1=0.773338675, test_loss=0.229054645, test_auc=0.956432641, test_f1=0.754848957
[k=10, precision=36.129%, recall=10.908%, f1=16.756%]
epoch=9, train_loss=0.21537143, train_auc=0.963754535, train_f1=0.774959445, test_loss=0.228505313, test_auc=0.956820309, test_f1=0.756008863
[k=10, precision=36.272%, recall=10.951%, f1=16.822%]
epoch=10, train_loss=0.214720622, train_auc=0.964211464, train_f1=0.776486635, test_loss=0.228102967, test_auc=0.957159936, test_f1=0.757019162
[k=10, precision=36.121%, recall=10.905%, f1=16.753%]
epoch=11, train_loss=0.214193389, train_auc=0.96450007, train_f1=0.77638638, test_loss=0.227720752, test_auc=0.957406402, test_f1=0.757087827
[k=10, precision=36.197%, recall=10.928%, f1=16.788%]
epoch=12, train_loss=0.213860318, train_auc=0.964667261, train_f1=0.777325451, test_loss=0.227563307, test_auc=0.957511842, test_f1=0.757767916
[k=10, precision=36.194%, recall=10.927%, f1=16.786%]
epoch=13, train_loss=0.213524789, train_auc=0.964830458, train_f1=0.777946293, test_loss=0.227324918, test_auc=0.957640469, test_f1=0.758235455
[k=10, precision=36.063%, recall=10.888%, f1=16.726%]
epoch=14, train_loss=0.21323809, train_auc=0.965002954, train_f1=0.779196, test_loss=0.227101684, test_auc=0.957790434, test_f1=0.759470403
[k=10, precision=36.058%, recall=10.886%, f1=16.723%]
epoch=15, train_loss=0.213040292, train_auc=0.965102732, train_f1=0.778837919, test_loss=0.226923555, test_auc=0.95787251, test_f1=0.759156346
[k=10, precision=36.098%, recall=10.898%, f1=16.742%]
epoch=16, train_loss=0.212848037, train_auc=0.965201, train_f1=0.779230833, test_loss=0.226815075, test_auc=0.957932472, test_f1=0.75952208
[k=10, precision=36.089%, recall=10.896%, f1=16.738%]
epoch=17, train_loss=0.212690428, train_auc=0.96532768, train_f1=0.779667377, test_loss=0.226672277, test_auc=0.958046913, test_f1=0.759871662
[k=10, precision=36.118%, recall=10.904%, f1=16.751%]
epoch=18, train_loss=0.212577358, train_auc=0.96531111, train_f1=0.779107094, test_loss=0.226566628, test_auc=0.958047032, test_f1=0.759467781
[k=10, precision=35.988%, recall=10.865%, f1=16.691%]
epoch=19, train_loss=0.212444261, train_auc=0.96533525, train_f1=0.779356182, test_loss=0.226461604, test_auc=0.958070099, test_f1=0.759563386
[k=10, precision=35.975%, recall=10.861%, f1=16.685%]
epoch=20, train_loss=0.212262914, train_auc=0.965436339, train_f1=0.780737877, test_loss=0.226293907, test_auc=0.958166122, test_f1=0.760905206
[k=10, precision=36.070%, recall=10.890%, f1=16.729%]
epoch=21, train_loss=0.212143257, train_auc=0.965461135, train_f1=0.780777574, test_loss=0.22622937, test_auc=0.958182931, test_f1=0.760709167
[k=10, precision=36.104%, recall=10.900%, f1=16.745%]
epoch=22, train_loss=0.212028608, train_auc=0.965558469, train_f1=0.780963659, test_loss=0.226108968, test_auc=0.958263457, test_f1=0.761107624
[k=10, precision=35.940%, recall=10.851%, f1=16.669%]
epoch=23, train_loss=0.211957037, train_auc=0.965633929, train_f1=0.780221939, test_loss=0.226101786, test_auc=0.958285034, test_f1=0.760323167
[k=10, precision=36.023%, recall=10.876%, f1=16.707%]
epoch=24, train_loss=0.211867392, train_auc=0.965649784, train_f1=0.78085506, test_loss=0.225994453, test_auc=0.958340704, test_f1=0.760816216
[k=10, precision=36.094%, recall=10.897%, f1=16.740%]
epoch=25, train_loss=0.211799428, train_auc=0.965672493, train_f1=0.781026185, test_loss=0.225914776, test_auc=0.958361745, test_f1=0.761090636
[k=10, precision=36.002%, recall=10.869%, f1=16.697%]
epoch=26, train_loss=0.211772129, train_auc=0.965620756, train_f1=0.780595899, test_loss=0.225895718, test_auc=0.958329439, test_f1=0.760755658
[k=10, precision=36.113%, recall=10.903%, f1=16.749%]
epoch=27, train_loss=0.211581767, train_auc=0.96571213, train_f1=0.78070271, test_loss=0.225731447, test_auc=0.958411634, test_f1=0.760652363
[k=10, precision=36.200%, recall=10.929%, f1=16.789%]
epoch=28, train_loss=0.211570427, train_auc=0.965767682, train_f1=0.781763077, test_loss=0.225707591, test_auc=0.958447099, test_f1=0.76181221
[k=10, precision=36.131%, recall=10.908%, f1=16.757%]
epoch=29, train_loss=0.211511299, train_auc=0.965734899, train_f1=0.782200396, test_loss=0.225693285, test_auc=0.958424091, test_f1=0.762109
[k=10, precision=36.283%, recall=10.954%, f1=16.828%]
epoch=30, train_loss=0.211421937, train_auc=0.965753555, train_f1=0.782052815, test_loss=0.225570157, test_auc=0.958451152, test_f1=0.761981487
[k=10, precision=36.161%, recall=10.917%, f1=16.771%]
（耗时6529.508556604385秒）