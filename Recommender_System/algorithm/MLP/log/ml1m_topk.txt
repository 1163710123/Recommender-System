Python 3.7.5 (tags/v3.7.5:5c02a39a0b, Oct 15 2019, 00:11:34) [MSC v.1916 64 bit (AMD64)] on win32
runfile('D:/work/PycharmProjects/test/Recommender_System/algorithm/MLP/main.py', wdir='D:/work/PycharmProjects/test/Recommender_System/algorithm/MLP')
开始读数据ml-1m。共1000209条数据，有6040个用户，3706个电影。
（耗时1.9297502040863037秒）
开始采集负样本，负正样本比例为5，方法为random。
（耗时10.527946710586548秒）
开始数据切分，test_ratio=0.2, shuffle=True
（耗时4.263247013092041秒）
开始准备topk评估数据，n_sample_user=6040
（耗时52.640429735183716秒）
初始化MLP模型：n_user=6040, n_item=3706, dim=64, layers=[112, 96, 80, 64], l2=2e-06
2019-11-20 10:42:54.083030: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2
开始训练：epochs=30, batch=512
epoch=1, train_loss=0.297444254, train_auc=0.897173584, train_f1=0.57899797, test_loss=0.298798144, test_auc=0.896018505, test_f1=0.577044189
[k=10, precision=23.690%, recall=7.163%, f1=11.000%]
epoch=2, train_loss=0.270123124, train_auc=0.922029674, train_f1=0.639277577, test_loss=0.272541136, test_auc=0.920135736, test_f1=0.635627389
[k=10, precision=28.518%, recall=8.622%, f1=13.241%]
epoch=3, train_loss=0.257923514, train_auc=0.931364775, train_f1=0.663844168, test_loss=0.261328876, test_auc=0.929035187, test_f1=0.658803
[k=10, precision=30.978%, recall=9.366%, f1=14.384%]
epoch=4, train_loss=0.250548154, train_auc=0.93751055, train_f1=0.697338164, test_loss=0.254691601, test_auc=0.934771061, test_f1=0.691313744
[k=10, precision=32.430%, recall=9.805%, f1=15.058%]
epoch=5, train_loss=0.245006084, train_auc=0.941595674, train_f1=0.693405449, test_loss=0.250032902, test_auc=0.938353598, test_f1=0.6860677
[k=10, precision=33.184%, recall=10.033%, f1=15.407%]
epoch=6, train_loss=0.240192324, train_auc=0.944795489, train_f1=0.709092259, test_loss=0.245859087, test_auc=0.941351712, test_f1=0.701266468
[k=10, precision=33.354%, recall=10.084%, f1=15.487%]
epoch=7, train_loss=0.23751004, train_auc=0.947671831, train_f1=0.71184, test_loss=0.243820682, test_auc=0.94370985, test_f1=0.70265913
[k=10, precision=33.829%, recall=10.228%, f1=15.707%]
epoch=8, train_loss=0.233975381, train_auc=0.950089216, train_f1=0.726536214, test_loss=0.240937799, test_auc=0.945836961, test_f1=0.716552198
[k=10, precision=34.291%, recall=10.368%, f1=15.922%]
epoch=9, train_loss=0.230908126, train_auc=0.95200336, train_f1=0.727465212, test_loss=0.238604143, test_auc=0.947459698, test_f1=0.716850579
[k=10, precision=34.384%, recall=10.396%, f1=15.965%]
epoch=10, train_loss=0.229002923, train_auc=0.954203308, train_f1=0.737215817, test_loss=0.237206176, test_auc=0.94925493, test_f1=0.725392818
[k=10, precision=34.599%, recall=10.461%, f1=16.065%]
epoch=11, train_loss=0.226093546, train_auc=0.955496192, train_f1=0.746199131, test_loss=0.235301897, test_auc=0.950252891, test_f1=0.733565271
[k=10, precision=34.379%, recall=10.394%, f1=15.962%]
epoch=12, train_loss=0.223821819, train_auc=0.95726943, train_f1=0.752654552, test_loss=0.233816564, test_auc=0.951645374, test_f1=0.739313781
[k=10, precision=34.267%, recall=10.360%, f1=15.910%]
epoch=13, train_loss=0.222524405, train_auc=0.95854342, train_f1=0.753302574, test_loss=0.232981086, test_auc=0.952674568, test_f1=0.739038527
[k=10, precision=34.402%, recall=10.401%, f1=15.973%]
epoch=14, train_loss=0.220740825, train_auc=0.959587336, train_f1=0.760326743, test_loss=0.2320548, test_auc=0.953487039, test_f1=0.745549202
[k=10, precision=34.455%, recall=10.417%, f1=15.998%]
epoch=15, train_loss=0.218689099, train_auc=0.960634708, train_f1=0.763001502, test_loss=0.230724946, test_auc=0.95427686, test_f1=0.74745357
[k=10, precision=34.152%, recall=10.326%, f1=15.857%]
epoch=16, train_loss=0.218456611, train_auc=0.961820781, train_f1=0.768253, test_loss=0.230694801, test_auc=0.955104709, test_f1=0.751488447
[k=10, precision=34.320%, recall=10.376%, f1=15.935%]
epoch=17, train_loss=0.21667254, train_auc=0.962124407, train_f1=0.761219203, test_loss=0.229954541, test_auc=0.955285668, test_f1=0.744593561
[k=10, precision=34.369%, recall=10.391%, f1=15.958%]
epoch=18, train_loss=0.215684563, train_auc=0.963488579, train_f1=0.774776876, test_loss=0.229173526, test_auc=0.956389844, test_f1=0.757009
[k=10, precision=33.798%, recall=10.219%, f1=15.693%]
epoch=19, train_loss=0.212246925, train_auc=0.964340448, train_f1=0.773075, test_loss=0.227149233, test_auc=0.956943, test_f1=0.754680336
[k=10, precision=33.732%, recall=10.199%, f1=15.662%]
epoch=20, train_loss=0.213567778, train_auc=0.964891732, train_f1=0.775332272, test_loss=0.227931932, test_auc=0.957333922, test_f1=0.756382465
[k=10, precision=33.672%, recall=10.181%, f1=15.634%]
epoch=21, train_loss=0.213668644, train_auc=0.965511918, train_f1=0.772131562, test_loss=0.228109375, test_auc=0.957723439, test_f1=0.752780557
[k=10, precision=33.575%, recall=10.151%, f1=15.589%]
epoch=22, train_loss=0.210702851, train_auc=0.965846241, train_f1=0.780765533, test_loss=0.226606086, test_auc=0.957937777, test_f1=0.761251092
[k=10, precision=33.694%, recall=10.187%, f1=15.644%]
2019-11-20 15:35:57.084078: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:143] Filling up shuffle buffer (this may take a while): 4423253 of 4538021
2019-11-20 15:35:57.226580: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:193] Shuffle buffer filled.
epoch=23, train_loss=0.210753843, train_auc=0.966626883, train_f1=0.773597, test_loss=0.226742804, test_auc=0.958444476, test_f1=0.753134251
[k=10, precision=33.637%, recall=10.170%, f1=15.618%]
epoch=24, train_loss=0.210335419, train_auc=0.966715038, train_f1=0.77528441, test_loss=0.226739883, test_auc=0.958462536, test_f1=0.755058825
[k=10, precision=33.618%, recall=10.164%, f1=15.609%]
epoch=25, train_loss=0.209553152, train_auc=0.967248797, train_f1=0.778629363, test_loss=0.226059541, test_auc=0.958975852, test_f1=0.757643282
[k=10, precision=33.338%, recall=10.079%, f1=15.479%]
epoch=26, train_loss=0.209540948, train_auc=0.967742, train_f1=0.78923279, test_loss=0.226124749, test_auc=0.959320962, test_f1=0.767920554
[k=10, precision=33.391%, recall=10.095%, f1=15.504%]
epoch=27, train_loss=0.20820789, train_auc=0.968111753, train_f1=0.787602961, test_loss=0.225558177, test_auc=0.959451616, test_f1=0.765383244
[k=10, precision=33.224%, recall=10.045%, f1=15.426%]
epoch=28, train_loss=0.208105683, train_auc=0.967978299, train_f1=0.791827381, test_loss=0.22602801, test_auc=0.959295, test_f1=0.769831538
[k=10, precision=32.950%, recall=9.962%, f1=15.299%]
epoch=29, train_loss=0.209137514, train_auc=0.968416214, train_f1=0.791289628, test_loss=0.226344958, test_auc=0.95975244, test_f1=0.769113839
[k=10, precision=33.215%, recall=10.042%, f1=15.422%]
epoch=30, train_loss=0.207278639, train_auc=0.969015658, train_f1=0.790745556, test_loss=0.224815369, test_auc=0.960222304, test_f1=0.768510759
[k=10, precision=33.402%, recall=10.099%, f1=15.509%]
（耗时25848.847567796707秒）