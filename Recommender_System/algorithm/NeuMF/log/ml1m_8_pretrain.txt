Python 3.7.5 (tags/v3.7.5:5c02a39a0b, Oct 15 2019, 00:11:34) [MSC v.1916 64 bit (AMD64)] on win32
runfile('D:/work/PycharmProjects/test/Recommender_System/algorithm/NeuMF/main.py', wdir='D:/work/PycharmProjects/test/Recommender_System/algorithm/NeuMF')
开始读数据ml-1m。共1000209条数据，有6040个用户，3706个电影。
（耗时2.1996374130249023秒）
开始采集负样本，负正样本比例为1，方法为random。
（耗时9.128036737442017秒）
开始数据切分，test_ratio=0.2, shuffle=True
（耗时1.6615698337554932秒）
开始准备topk评估数据，n_sample_user=100
（耗时5.767201662063599秒）
初始化GMF模型：n_user=6040, n_item=3706, dim=8, l2=0
2019-11-22 14:40:35.662343: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2
开始训练：epochs=10, batch=512
epoch=1, train_loss=0.448867887, train_auc=0.870360374, train_f1=0.788298845, test_loss=0.450392097, test_auc=0.8693887, test_f1=0.787673056
[k=10, precision=20.600%, recall=5.703%, f1=8.933%][k=36, precision=15.194%, recall=15.144%, f1=15.169%][k=100, precision=10.880%, recall=30.122%, f1=15.986%]
epoch=2, train_loss=0.429828435, train_auc=0.880719244, train_f1=0.799693644, test_loss=0.432127088, test_auc=0.87939328, test_f1=0.798981965
[k=10, precision=20.800%, recall=5.759%, f1=9.020%][k=36, precision=15.417%, recall=15.365%, f1=15.391%][k=100, precision=11.210%, recall=31.035%, f1=16.471%]
epoch=3, train_loss=0.410411477, train_auc=0.892081797, train_f1=0.813546717, test_loss=0.413483083, test_auc=0.890377641, test_f1=0.812418
[k=10, precision=21.000%, recall=5.814%, f1=9.107%][k=36, precision=16.278%, recall=16.224%, f1=16.251%][k=100, precision=11.380%, recall=31.506%, f1=16.721%]
epoch=4, train_loss=0.386151105, train_auc=0.905568898, train_f1=0.828173935, test_loss=0.390387386, test_auc=0.903347313, test_f1=0.826387286
[k=10, precision=22.300%, recall=6.174%, f1=9.670%][k=36, precision=17.167%, recall=17.110%, f1=17.138%][k=100, precision=12.200%, recall=33.776%, f1=17.925%]
epoch=5, train_loss=0.369330496, train_auc=0.914080381, train_f1=0.837672889, test_loss=0.374661386, test_auc=0.911428213, test_f1=0.835141361
[k=10, precision=24.200%, recall=6.700%, f1=10.494%][k=36, precision=18.444%, recall=18.383%, f1=18.414%][k=100, precision=12.970%, recall=35.908%, f1=19.057%]
epoch=6, train_loss=0.359014779, train_auc=0.918967068, train_f1=0.843101621, test_loss=0.365213811, test_auc=0.916004062, test_f1=0.840256453
[k=10, precision=25.400%, recall=7.032%, f1=11.015%][k=36, precision=18.944%, recall=18.882%, f1=18.913%][k=100, precision=13.300%, recall=36.822%, f1=19.542%]
epoch=7, train_loss=0.350790054, train_auc=0.922810256, train_f1=0.847302377, test_loss=0.357787907, test_auc=0.919557, test_f1=0.844141364
[k=10, precision=25.900%, recall=7.171%, f1=11.232%][k=36, precision=19.417%, recall=19.352%, f1=19.384%][k=100, precision=13.770%, recall=38.123%, f1=20.232%]
epoch=8, train_loss=0.344310075, train_auc=0.925738931, train_f1=0.850886106, test_loss=0.351989061, test_auc=0.922261417, test_f1=0.847397864
[k=10, precision=26.900%, recall=7.447%, f1=11.665%][k=36, precision=20.222%, recall=20.155%, f1=20.189%][k=100, precision=14.130%, recall=39.120%, f1=20.761%]
epoch=9, train_loss=0.339580089, train_auc=0.927780867, train_f1=0.85276711, test_loss=0.347905368, test_auc=0.924093962, test_f1=0.849080086
[k=10, precision=26.900%, recall=7.447%, f1=11.665%][k=36, precision=20.333%, recall=20.266%, f1=20.300%][k=100, precision=14.070%, recall=38.953%, f1=20.673%]
epoch=10, train_loss=0.336243153, train_auc=0.929215193, train_f1=0.854512215, test_loss=0.344995677, test_auc=0.925392449, test_f1=0.850709319
[k=10, precision=27.300%, recall=7.558%, f1=11.839%][k=36, precision=20.472%, recall=20.404%, f1=20.438%][k=100, precision=14.260%, recall=39.480%, f1=20.952%]
（耗时202.56657195091248秒）
初始化MLP模型：n_user=6040, n_item=3706, dim=32, layers=[32, 16, 8], l2=0
开始训练：epochs=10, batch=512
epoch=1, train_loss=0.451427937, train_auc=0.866705835, train_f1=0.789890349, test_loss=0.453241765, test_auc=0.865544617, test_f1=0.788950086
[k=10, precision=19.400%, recall=5.371%, f1=8.413%][k=36, precision=13.861%, recall=13.815%, f1=13.838%][k=100, precision=10.090%, recall=27.935%, f1=14.825%]
epoch=2, train_loss=0.408817381, train_auc=0.892878473, train_f1=0.814531803, test_loss=0.412562072, test_auc=0.890740216, test_f1=0.812723
[k=10, precision=20.400%, recall=5.648%, f1=8.846%][k=36, precision=16.361%, recall=16.307%, f1=16.334%][k=100, precision=11.440%, recall=31.672%, f1=16.809%]
epoch=3, train_loss=0.385150969, train_auc=0.905717134, train_f1=0.831612766, test_loss=0.39081493, test_auc=0.902715385, test_f1=0.828772
[k=10, precision=21.400%, recall=5.925%, f1=9.280%][k=36, precision=17.944%, recall=17.885%, f1=17.915%][k=100, precision=12.320%, recall=34.109%, f1=18.102%]
epoch=4, train_loss=0.362684101, train_auc=0.917961478, train_f1=0.841417968, test_loss=0.370269775, test_auc=0.914037168, test_f1=0.837373853
[k=10, precision=24.000%, recall=6.645%, f1=10.408%][k=36, precision=18.194%, recall=18.134%, f1=18.164%][k=100, precision=13.100%, recall=36.268%, f1=19.248%]
epoch=5, train_loss=0.341384143, train_auc=0.926807702, train_f1=0.853953958, test_loss=0.351223767, test_auc=0.922328889, test_f1=0.849257708
[k=10, precision=24.600%, recall=6.811%, f1=10.668%][k=36, precision=19.278%, recall=19.214%, f1=19.246%][k=100, precision=13.710%, recall=37.957%, f1=20.144%]
epoch=6, train_loss=0.325411886, train_auc=0.934218705, train_f1=0.862045646, test_loss=0.337307304, test_auc=0.928841, test_f1=0.856235683
[k=10, precision=26.800%, recall=7.420%, f1=11.622%][k=36, precision=20.083%, recall=20.017%, f1=20.050%][k=100, precision=13.780%, recall=38.151%, f1=20.247%]
epoch=7, train_loss=0.313925833, train_auc=0.938904166, train_f1=0.868509829, test_loss=0.327865, test_auc=0.932875752, test_f1=0.861948848
[k=10, precision=27.100%, recall=7.503%, f1=11.752%][k=36, precision=19.694%, recall=19.629%, f1=19.662%][k=100, precision=13.750%, recall=38.068%, f1=20.203%]
epoch=8, train_loss=0.303445607, train_auc=0.942938864, train_f1=0.872527242, test_loss=0.319582224, test_auc=0.936228871, test_f1=0.864941955
[k=10, precision=27.100%, recall=7.503%, f1=11.752%][k=36, precision=20.139%, recall=20.072%, f1=20.105%][k=100, precision=14.060%, recall=38.926%, f1=20.658%]
epoch=9, train_loss=0.295633078, train_auc=0.945823908, train_f1=0.876125038, test_loss=0.313852876, test_auc=0.938497663, test_f1=0.867890358
[k=10, precision=28.400%, recall=7.863%, f1=12.316%][k=36, precision=20.028%, recall=19.961%, f1=19.994%][k=100, precision=14.190%, recall=39.286%, f1=20.849%]
epoch=10, train_loss=0.288964897, train_auc=0.94833529, train_f1=0.880003631, test_loss=0.308840603, test_auc=0.940492392, test_f1=0.871017277
[k=10, precision=27.100%, recall=7.503%, f1=11.752%][k=36, precision=20.333%, recall=20.266%, f1=20.300%][k=100, precision=14.020%, recall=38.815%, f1=20.599%]
（耗时333.15628957748413秒）
初始化NeuMF模型：n_user=6040, n_item=3706, gmf_dim=8, mlp_dim=32, layers=[32, 16, 8], l2=0
开始评估：epochs=1, batch=512
epoch=1, train_loss=0.299194425, train_auc=0.944985926, train_f1=0.875215232, test_loss=0.313283414, test_auc=0.93908608, test_f1=0.868486
[k=10, precision=28.900%, recall=8.001%, f1=12.533%][k=36, precision=21.222%, recall=21.152%, f1=21.187%][k=100, precision=14.730%, recall=40.781%, f1=21.643%]
（耗时19.861421823501587秒）
开始训练：epochs=30, batch=512
epoch=1, train_loss=0.276552409, train_auc=0.952661, train_f1=0.885354877, test_loss=0.297667384, test_auc=0.944796741, test_f1=0.87625128
[k=10, precision=27.400%, recall=7.586%, f1=11.882%][k=36, precision=20.556%, recall=20.487%, f1=20.521%][k=100, precision=14.390%, recall=39.839%, f1=21.143%]
epoch=2, train_loss=0.266435891, train_auc=0.956110716, train_f1=0.890644789, test_loss=0.290668428, test_auc=0.947399795, test_f1=0.88025558
[k=10, precision=27.800%, recall=7.697%, f1=12.056%][k=36, precision=20.944%, recall=20.875%, f1=20.910%][k=100, precision=14.530%, recall=40.227%, f1=21.349%]
epoch=3, train_loss=0.258838713, train_auc=0.959231615, train_f1=0.895887673, test_loss=0.285684675, test_auc=0.949656188, test_f1=0.884646654
[k=10, precision=26.000%, recall=7.198%, f1=11.275%][k=36, precision=20.111%, recall=20.044%, f1=20.078%][k=100, precision=14.140%, recall=39.147%, f1=20.776%]
epoch=4, train_loss=0.24955754, train_auc=0.961488366, train_f1=0.899007618, test_loss=0.279642045, test_auc=0.951384127, test_f1=0.886791945
[k=10, precision=26.200%, recall=7.254%, f1=11.362%][k=36, precision=19.722%, recall=19.657%, f1=19.689%][k=100, precision=14.070%, recall=38.953%, f1=20.673%]
epoch=5, train_loss=0.242517, train_auc=0.96392709, train_f1=0.902490854, test_loss=0.275696665, test_auc=0.952974617, test_f1=0.889326811
[k=10, precision=26.100%, recall=7.226%, f1=11.318%][k=36, precision=19.056%, recall=18.992%, f1=19.024%][k=100, precision=14.060%, recall=38.926%, f1=20.658%]
epoch=6, train_loss=0.236358225, train_auc=0.965292215, train_f1=0.904117, test_loss=0.273050517, test_auc=0.953958869, test_f1=0.890502036
[k=10, precision=24.700%, recall=6.838%, f1=10.711%][k=36, precision=19.500%, recall=19.435%, f1=19.468%][k=100, precision=14.340%, recall=39.701%, f1=21.070%]
epoch=7, train_loss=0.229971543, train_auc=0.96722585, train_f1=0.907627225, test_loss=0.269928634, test_auc=0.955045521, test_f1=0.892874539
[k=10, precision=23.400%, recall=6.478%, f1=10.147%][k=36, precision=18.583%, recall=18.522%, f1=18.552%][k=100, precision=13.860%, recall=38.372%, f1=20.364%]
epoch=8, train_loss=0.224653885, train_auc=0.969149, train_f1=0.910596371, test_loss=0.267719388, test_auc=0.956048727, test_f1=0.894858
[k=10, precision=21.600%, recall=5.980%, f1=9.367%][k=36, precision=17.944%, recall=17.885%, f1=17.915%][k=100, precision=13.600%, recall=37.652%, f1=19.982%]
epoch=9, train_loss=0.220708832, train_auc=0.970392883, train_f1=0.912775218, test_loss=0.266659468, test_auc=0.956842959, test_f1=0.896773219
[k=10, precision=22.300%, recall=6.174%, f1=9.670%][k=36, precision=18.083%, recall=18.023%, f1=18.053%][k=100, precision=13.390%, recall=37.071%, f1=19.674%]
epoch=10, train_loss=0.214670554, train_auc=0.971753538, train_f1=0.915204883, test_loss=0.26380223, test_auc=0.957560778, test_f1=0.898081601
[k=10, precision=21.400%, recall=5.925%, f1=9.280%][k=36, precision=17.222%, recall=17.165%, f1=17.194%][k=100, precision=13.190%, recall=36.517%, f1=19.380%]
epoch=11, train_loss=0.210323244, train_auc=0.972612858, train_f1=0.916279, test_loss=0.261576474, test_auc=0.958413243, test_f1=0.899126589
[k=10, precision=21.600%, recall=5.980%, f1=9.367%][k=36, precision=17.361%, recall=17.303%, f1=17.332%][k=100, precision=13.390%, recall=37.071%, f1=19.674%]
epoch=12, train_loss=0.206609905, train_auc=0.973417461, train_f1=0.916670442, test_loss=0.261604846, test_auc=0.958806098, test_f1=0.899048269
[k=10, precision=20.600%, recall=5.703%, f1=8.933%][k=36, precision=17.139%, recall=17.082%, f1=17.110%][k=100, precision=12.960%, recall=35.880%, f1=19.042%]
epoch=13, train_loss=0.203462273, train_auc=0.97416383, train_f1=0.918430805, test_loss=0.261680901, test_auc=0.958916426, test_f1=0.899984241
[k=10, precision=20.100%, recall=5.565%, f1=8.716%][k=36, precision=17.444%, recall=17.386%, f1=17.415%][k=100, precision=13.080%, recall=36.213%, f1=19.218%]
epoch=14, train_loss=0.200431347, train_auc=0.97513324, train_f1=0.92069149, test_loss=0.259722292, test_auc=0.959521711, test_f1=0.901614726
[k=10, precision=19.200%, recall=5.316%, f1=8.326%][k=36, precision=16.778%, recall=16.722%, f1=16.750%][k=100, precision=12.830%, recall=35.520%, f1=18.851%]
epoch=15, train_loss=0.197146833, train_auc=0.975915313, train_f1=0.922547, test_loss=0.260285288, test_auc=0.959867179, test_f1=0.903409123
[k=10, precision=19.000%, recall=5.260%, f1=8.239%][k=36, precision=16.667%, recall=16.611%, f1=16.639%][k=100, precision=12.570%, recall=34.801%, f1=18.469%]
epoch=16, train_loss=0.194344148, train_auc=0.976511776, train_f1=0.922762573, test_loss=0.259799749, test_auc=0.96012342, test_f1=0.903001547
[k=10, precision=18.400%, recall=5.094%, f1=7.979%][k=36, precision=15.972%, recall=15.919%, f1=15.946%][k=100, precision=12.660%, recall=35.050%, f1=18.601%]
epoch=17, train_loss=0.190872252, train_auc=0.977199495, train_f1=0.923948109, test_loss=0.260929525, test_auc=0.96026814, test_f1=0.903643966
[k=10, precision=17.900%, recall=4.956%, f1=7.762%][k=36, precision=16.222%, recall=16.168%, f1=16.195%][k=100, precision=12.420%, recall=34.385%, f1=18.249%]
epoch=18, train_loss=0.188846335, train_auc=0.977792263, train_f1=0.925687075, test_loss=0.259918123, test_auc=0.96056211, test_f1=0.905071
[k=10, precision=19.600%, recall=5.426%, f1=8.500%][k=36, precision=15.694%, recall=15.642%, f1=15.668%][k=100, precision=12.290%, recall=34.025%, f1=18.058%]
epoch=19, train_loss=0.18701148, train_auc=0.978084207, train_f1=0.925610662, test_loss=0.260808498, test_auc=0.960707903, test_f1=0.904659629
[k=10, precision=18.200%, recall=5.039%, f1=7.892%][k=36, precision=15.917%, recall=15.864%, f1=15.890%][k=100, precision=12.340%, recall=34.164%, f1=18.131%]
epoch=20, train_loss=0.185833946, train_auc=0.97822988, train_f1=0.926051617, test_loss=0.260596573, test_auc=0.960821, test_f1=0.904866219
[k=10, precision=18.900%, recall=5.233%, f1=8.196%][k=36, precision=15.806%, recall=15.753%, f1=15.779%][k=100, precision=12.470%, recall=34.524%, f1=18.322%]
epoch=21, train_loss=0.182199806, train_auc=0.979028, train_f1=0.928003311, test_loss=0.259657621, test_auc=0.961431205, test_f1=0.906914413
[k=10, precision=18.300%, recall=5.066%, f1=7.936%][k=36, precision=15.389%, recall=15.338%, f1=15.363%][k=100, precision=12.250%, recall=33.915%, f1=17.999%]
epoch=22, train_loss=0.18161653, train_auc=0.979297459, train_f1=0.928454638, test_loss=0.261309117, test_auc=0.961516, test_f1=0.907613158
[k=10, precision=18.600%, recall=5.150%, f1=8.066%][k=36, precision=15.667%, recall=15.615%, f1=15.641%][k=100, precision=12.160%, recall=33.666%, f1=17.867%]
epoch=23, train_loss=0.177764118, train_auc=0.979958534, train_f1=0.929633081, test_loss=0.261697412, test_auc=0.961646557, test_f1=0.907983
[k=10, precision=16.600%, recall=4.596%, f1=7.199%][k=36, precision=14.944%, recall=14.895%, f1=14.920%][k=100, precision=12.000%, recall=33.223%, f1=17.632%]
epoch=24, train_loss=0.176385313, train_auc=0.980170667, train_f1=0.930085838, test_loss=0.264756233, test_auc=0.961409926, test_f1=0.907969236
[k=10, precision=17.500%, recall=4.845%, f1=7.589%][k=36, precision=14.694%, recall=14.646%, f1=14.670%][k=100, precision=11.860%, recall=32.835%, f1=17.426%]
epoch=25, train_loss=0.175792754, train_auc=0.980429053, train_f1=0.930513, test_loss=0.262634546, test_auc=0.961663127, test_f1=0.908236623
[k=10, precision=18.100%, recall=5.011%, f1=7.849%][k=36, precision=14.667%, recall=14.618%, f1=14.642%][k=100, precision=11.830%, recall=32.752%, f1=17.382%]
epoch=26, train_loss=0.174865052, train_auc=0.980716169, train_f1=0.931459308, test_loss=0.263584703, test_auc=0.961954534, test_f1=0.909463763
[k=10, precision=17.600%, recall=4.873%, f1=7.632%][k=36, precision=15.333%, recall=15.282%, f1=15.308%][k=100, precision=11.970%, recall=33.140%, f1=17.587%]
epoch=27, train_loss=0.172643587, train_auc=0.981016338, train_f1=0.931931794, test_loss=0.264063895, test_auc=0.962070882, test_f1=0.909690142
[k=10, precision=17.800%, recall=4.928%, f1=7.719%][k=36, precision=14.583%, recall=14.535%, f1=14.559%][k=100, precision=11.470%, recall=31.755%, f1=16.853%]
epoch=28, train_loss=0.17096, train_auc=0.981388509, train_f1=0.932619095, test_loss=0.264609605, test_auc=0.962061107, test_f1=0.909975648
[k=10, precision=16.700%, recall=4.623%, f1=7.242%][k=36, precision=14.111%, recall=14.064%, f1=14.088%][k=100, precision=11.650%, recall=32.254%, f1=17.117%]
epoch=29, train_loss=0.169732988, train_auc=0.981622517, train_f1=0.933272, test_loss=0.26417309, test_auc=0.962184787, test_f1=0.910315394
[k=10, precision=16.700%, recall=4.623%, f1=7.242%][k=36, precision=14.306%, recall=14.258%, f1=14.282%][k=100, precision=11.580%, recall=32.060%, f1=17.014%]
epoch=30, train_loss=0.16873239, train_auc=0.981876135, train_f1=0.93386662, test_loss=0.264088243, test_auc=0.9623546, test_f1=0.910781562
[k=10, precision=17.000%, recall=4.707%, f1=7.372%][k=36, precision=14.778%, recall=14.729%, f1=14.753%][k=100, precision=11.750%, recall=32.530%, f1=17.264%]
（耗时1173.7358157634735秒）
