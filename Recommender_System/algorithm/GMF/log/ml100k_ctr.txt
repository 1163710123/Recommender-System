Python 3.7.5 (tags/v3.7.5:5c02a39a0b, Oct 15 2019, 00:11:34) [MSC v.1916 64 bit (AMD64)] on win32
runfile('D:/work/PycharmProjects/test/Recommender_System/algorithm/GMF/main.py', wdir='D:/work/PycharmProjects/test/Recommender_System/algorithm/GMF')
开始读数据ml-100k。共100000条数据，有943个用户，1682个电影。
（耗时0.16544151306152344秒）
开始采集负样本，负正样本比例为1，方法为random。
（耗时0.6286745071411133秒）
开始数据切分，test_ratio=0.2, shuffle=True
（耗时0.12494158744812012秒）
开始准备topk评估数据，n_sample_user=943
（耗时0.7654449939727783秒）
初始化GMF模型：n_user=943, n_item=1682, dim=100, l2=1e-05
2019-11-13 10:10:31.909690: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2
开始训练：epochs=30, batch=512
epoch=1, train_loss=0.643713295, train_auc=0.858875036, train_f1=0.797147214, test_loss=0.644442201, test_auc=0.855256915, test_f1=0.794017851
[k=10, precision=21.357%, recall=10.009%, f1=13.630%]
epoch=2, train_loss=0.49904412, train_auc=0.868471742, train_f1=0.796217561, test_loss=0.501730382, test_auc=0.866042554, test_f1=0.794633448
[k=10, precision=23.256%, recall=10.899%, f1=14.842%]
epoch=3, train_loss=0.472398698, train_auc=0.890309334, train_f1=0.815794826, test_loss=0.476548135, test_auc=0.887113154, test_f1=0.813566387
[k=10, precision=25.323%, recall=11.868%, f1=16.161%]
epoch=4, train_loss=0.453264, train_auc=0.906701684, train_f1=0.831642091, test_loss=0.458818913, test_auc=0.902775168, test_f1=0.828499556
[k=10, precision=26.670%, recall=12.499%, f1=17.021%]
epoch=5, train_loss=0.441180825, train_auc=0.916725039, train_f1=0.842073441, test_loss=0.447985113, test_auc=0.912172496, test_f1=0.838377237
[k=10, precision=28.134%, recall=13.185%, f1=17.955%]
epoch=6, train_loss=0.432863086, train_auc=0.923514843, train_f1=0.849249899, test_loss=0.440855443, test_auc=0.918394268, test_f1=0.844681919
[k=10, precision=28.759%, recall=13.478%, f1=18.354%]
epoch=7, train_loss=0.426181197, train_auc=0.929050446, train_f1=0.855129182, test_loss=0.435305238, test_auc=0.923390687, test_f1=0.849891067
[k=10, precision=29.014%, recall=13.597%, f1=18.517%]
epoch=8, train_loss=0.420212626, train_auc=0.934267223, train_f1=0.861399651, test_loss=0.430491775, test_auc=0.928019166, test_f1=0.855350316
[k=10, precision=29.852%, recall=13.990%, f1=19.051%]
epoch=9, train_loss=0.414442122, train_auc=0.939046383, train_f1=0.866850793, test_loss=0.425925732, test_auc=0.932239, test_f1=0.860191345
[k=10, precision=29.905%, recall=14.015%, f1=19.085%]
epoch=10, train_loss=0.409162074, train_auc=0.943612874, train_f1=0.872370601, test_loss=0.421888381, test_auc=0.936223567, test_f1=0.864722729
[k=10, precision=30.244%, recall=14.174%, f1=19.302%]
epoch=11, train_loss=0.404168338, train_auc=0.947903037, train_f1=0.878356218, test_loss=0.418202937, test_auc=0.939922512, test_f1=0.869849384
[k=10, precision=30.477%, recall=14.283%, f1=19.450%]
epoch=12, train_loss=0.399343252, train_auc=0.951954126, train_f1=0.883962452, test_loss=0.414669037, test_auc=0.943433285, test_f1=0.874644101
[k=10, precision=30.944%, recall=14.502%, f1=19.748%]
epoch=13, train_loss=0.394619495, train_auc=0.955809057, train_f1=0.88928324, test_loss=0.411396384, test_auc=0.946688056, test_f1=0.879069746
[k=10, precision=31.209%, recall=14.626%, f1=19.917%]
epoch=14, train_loss=0.39014402, train_auc=0.959609747, train_f1=0.894485593, test_loss=0.408323795, test_auc=0.949906766, test_f1=0.883307457
[k=10, precision=31.304%, recall=14.671%, f1=19.978%]
epoch=15, train_loss=0.385790259, train_auc=0.963246942, train_f1=0.899865031, test_loss=0.405456036, test_auc=0.952962577, test_f1=0.887720704
[k=10, precision=31.474%, recall=14.750%, f1=20.087%]
epoch=16, train_loss=0.381571949, train_auc=0.966634393, train_f1=0.905034363, test_loss=0.402747452, test_auc=0.955804944, test_f1=0.891911268
[k=10, precision=31.707%, recall=14.859%, f1=20.236%]
epoch=17, train_loss=0.377488911, train_auc=0.969896555, train_f1=0.910066247, test_loss=0.400172949, test_auc=0.9585585, test_f1=0.89596647
[k=10, precision=31.707%, recall=14.859%, f1=20.236%]
epoch=18, train_loss=0.37372309, train_auc=0.972979128, train_f1=0.915397406, test_loss=0.397924274, test_auc=0.961139143, test_f1=0.900192082
[k=10, precision=31.813%, recall=14.909%, f1=20.303%]
epoch=19, train_loss=0.370000333, train_auc=0.975922823, train_f1=0.920343935, test_loss=0.395746469, test_auc=0.963610113, test_f1=0.904021204
[k=10, precision=31.909%, recall=14.954%, f1=20.364%]
epoch=20, train_loss=0.366563171, train_auc=0.978520751, train_f1=0.925159633, test_loss=0.39383623, test_auc=0.965794563, test_f1=0.90775758
[k=10, precision=31.909%, recall=14.954%, f1=20.364%]
epoch=21, train_loss=0.363279283, train_auc=0.980902135, train_f1=0.929857373, test_loss=0.392044663, test_auc=0.967810392, test_f1=0.911417365
[k=10, precision=32.078%, recall=15.033%, f1=20.472%]
epoch=22, train_loss=0.360268354, train_auc=0.983174682, train_f1=0.934806764, test_loss=0.390512884, test_auc=0.969737411, test_f1=0.915336072
[k=10, precision=32.047%, recall=15.018%, f1=20.452%]
epoch=23, train_loss=0.357475758, train_auc=0.985157609, train_f1=0.938950956, test_loss=0.389172614, test_auc=0.971416235, test_f1=0.918453753
[k=10, precision=31.983%, recall=14.989%, f1=20.411%]
epoch=24, train_loss=0.354883254, train_auc=0.986924946, train_f1=0.943095148, test_loss=0.387977123, test_auc=0.972940147, test_f1=0.921670437
[k=10, precision=31.972%, recall=14.984%, f1=20.405%]
epoch=25, train_loss=0.352520466, train_auc=0.988511801, train_f1=0.946872, test_loss=0.386974484, test_auc=0.974289298, test_f1=0.924571455
[k=10, precision=32.121%, recall=15.053%, f1=20.499%]
epoch=26, train_loss=0.35036242, train_auc=0.989943147, train_f1=0.950786412, test_loss=0.386093557, test_auc=0.975521445, test_f1=0.92759335
[k=10, precision=32.057%, recall=15.023%, f1=20.459%]
epoch=27, train_loss=0.348406136, train_auc=0.991187632, train_f1=0.954348862, test_loss=0.385393888, test_auc=0.976618171, test_f1=0.930288494
[k=10, precision=32.036%, recall=15.013%, f1=20.445%]
epoch=28, train_loss=0.346610069, train_auc=0.992298603, train_f1=0.95744735, test_loss=0.384752661, test_auc=0.977627039, test_f1=0.932727
[k=10, precision=31.962%, recall=14.979%, f1=20.398%]
epoch=29, train_loss=0.345016032, train_auc=0.993249238, train_f1=0.960445106, test_loss=0.384263456, test_auc=0.978475, test_f1=0.934968412
[k=10, precision=31.771%, recall=14.889%, f1=20.276%]
epoch=30, train_loss=0.343652278, train_auc=0.994100928, train_f1=0.963300943, test_loss=0.383929193, test_auc=0.979254603, test_f1=0.937156439
[k=10, precision=31.771%, recall=14.889%, f1=20.276%]
（耗时103.2243378162384秒）